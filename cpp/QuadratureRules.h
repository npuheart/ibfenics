/// @date 2023-05-02
/// @file quadrature.cpp
/// @author Ma Pengfei (code@pengfeima.cn)
/// @version 0.1
/// @copyright Copyright (c) 2023 Ma Pengfei
///
/// @brief 通过模板变量存储所有高斯积分点和高斯积分权重。我希望它是一个常量对象。
///
///

#ifndef __QUADRATURE_RULES__
#define __QUADRATURE_RULES__

/// https://zhuanlan.zhihu.com/p/579614849

#include <iostream>

/// provide double3
// #include <vector_types.h>

namespace npuheart {

class double3
{
public:
    // constexpr double3(double x, double y, double z):_x(x),_y(y),_z(z){}
    double _x, _y, _z;
};

// 高斯点和高斯权重通过basix计算，参考文档：
// https://docs.fenicsproject.org/basix/main/python/demo/demo_quadrature.py.html
// 代码：
// import basix
// import numpy as np
// from basix import ElementFamily, CellType, LagrangeVariant

// np.set_printoptions(precision=16)

// for i in range(10):
//     points, weights =
//     basix.make_quadrature(basix.QuadratureType.gauss_jacobi,CellType.interval,i)
//     print(i)
//     print(points)
//     print(weights)

// for i in range(10):
//     points, weights =
//     basix.make_quadrature(basix.QuadratureType.gauss_jacobi,CellType.triangle,i)
//     print(i)
//     print(points)
//     print(weights)
// for i in range(10):
//     points, weights =
//     basix.make_quadrature(basix.QuadratureType.gauss_jacobi,CellType.tetrahedron,i)
//     print(i)
//     print(points)
//     print(weights)

constexpr double3 points_1_1[1]  = {{0.5}};
constexpr double  weights_1_1[1] = {1.};

constexpr double3 points_3_1[2]  = {{0.2113248654051871}, {0.7886751345948129}};
constexpr double  weights_3_1[2] = {0.5, 0.5};

constexpr double3 points_5_1[3]  = {{0.1127016653792583}, {0.5}, {0.8872983346207417}};
constexpr double  weights_5_1[3] = {0.2777777777777777, 0.4444444444444444, 0.2777777777777777};

constexpr double3 points_7_1[4]
    = {{0.0694318442029737}, {0.3300094782075719}, {0.6699905217924281}, {0.9305681557970262}};
constexpr double weights_7_1[4] = {0.1739274225687268, 0.3260725774312731, 0.3260725774312731, 0.1739274225687268};

constexpr double3 points_9_1[5]
    = {{0.046910077030668}, {0.2307653449471584}, {0.5}, {0.7692346550528415}, {0.9530899229693319}};
constexpr double weights_9_1[5]
    = {0.1184634425280945, 0.2393143352496832, 0.2844444444444444, 0.2393143352496832, 0.1184634425280945};

constexpr double3 points_1_2[1]  = {{0.3333333333333333, 0.3333333333333334}};
constexpr double  weights_1_2[1] = {0.5};

constexpr double3 points_3_2[4]  = {{0.1785587282636164, 0.1550510257216822},
                                    {0.0750311102226081, 0.6449489742783178},
                                    {0.6663902460147014, 0.1550510257216822},
                                    {0.2800199154990741, 0.6449489742783178}};
constexpr double  weights_3_2[4] = {0.1590206908719886, 0.0909793091280114, 0.1590206908719886, 0.0909793091280114};

constexpr double3 points_5_2[9] = {{0.1027176548096263, 0.0885879595127039}, {0.0665540678391645, 0.4094668644407347},
                                   {0.0239311322870806, 0.7876594617608470}, {0.4557060202436480, 0.0885879595127039},
                                   {0.2952665677796327, 0.4094668644407347}, {0.1061702691195765, 0.7876594617608470},
                                   {0.8086943856776698, 0.0885879595127039}, {0.5239790677201008, 0.4094668644407347},
                                   {0.1884094059520723, 0.7876594617608470}};
constexpr double  weights_5_2[9]
    = {0.0558144204830443, 0.0636780850998850, 0.0193963833059595, 0.0893030727728709, 0.1018849361598161,
       0.0310342132895352, 0.0558144204830443, 0.0636780850998850, 0.0193963833059595};

constexpr double3 points_7_2[16]  = {{0.0654669945550145, 0.0571041961145177}, {0.0502101232113698, 0.2768430136381238},
                                     {0.028912084224389, 0.5835904323689168},  {0.0097037851269461, 0.8602401356562195},
                                     {0.311164552244357, 0.0571041961145177},  {0.2386486597314429, 0.2768430136381238},
                                     {0.1374191041345744, 0.5835904323689168}, {0.0461220799064521, 0.8602401356562195},
                                     {0.6317312516411253, 0.0571041961145177}, {0.4845083266304333, 0.2768430136381238},
                                     {0.2789904634965088, 0.5835904323689168}, {0.0936377844373285, 0.8602401356562195},
                                     {0.8774288093304679, 0.0571041961145177}, {0.6729468631505063, 0.2768430136381238},
                                     {0.3874974834066942, 0.5835904323689168}, {0.1300560792168345, 0.8602401356562195}};
constexpr double  weights_7_2[16] = {0.0235683681933823, 0.0353880678980859, 0.0225840492823699, 0.0054232259105253,
                                     0.0441850885223617, 0.0663442161070497, 0.0423397245217463, 0.0101672595644788,
                                     0.0441850885223617, 0.0663442161070497, 0.0423397245217463, 0.0101672595644788,
                                     0.0235683681933823, 0.0353880678980859, 0.0225840492823699, 0.0054232259105253};

constexpr double3 points_9_2[25] = {{0.0450425935698037, 0.0398098570514687}, {0.0376212523451112, 0.1980134178736082},
                                    {0.0263646449444709, 0.4379748102473862}, {0.0142857943955714, 0.695464273353636},
                                    {0.0046222884650464, 0.9014649142011736}, {0.2215786095523792, 0.0398098570514687},
                                    {0.1850707102673894, 0.1980134178736082}, {0.1296959367822541, 0.4379748102473862},
                                    {0.0702762920082817, 0.695464273353636},  {0.022738483063764, 0.9014649142011736},
                                    {0.4800950714742657, 0.0398098570514687}, {0.4009932910631959, 0.1980134178736082},
                                    {0.2810125948763069, 0.4379748102473862}, {0.152267863323182, 0.695464273353636},
                                    {0.0492675428994132, 0.9014649142011736}, {0.738611533396152, 0.0398098570514687},
                                    {0.6169158718590023, 0.1980134178736082}, {0.4323292529703597, 0.4379748102473862},
                                    {0.2342594346380822, 0.695464273353636},  {0.0757966027350624, 0.9014649142011736},
                                    {0.9151475493787276, 0.0398098570514687}, {0.7643653297812806, 0.1980134178736082},
                                    {0.5356605448081428, 0.4379748102473862}, {0.2902499322507925, 0.695464273353636},
                                    {0.09391279733378, 0.9014649142011736}};
constexpr double  weights_9_2[25]
    = {0.0114650803515925, 0.0198040831320473, 0.0173415064313657, 0.0087554991821638, 0.0018655521668778,
       0.0231612219294984, 0.0400072873861604, 0.0350325045033717, 0.0176874521104835, 0.0037687016953276,
       0.0275289856644698, 0.047551897057954,  0.041638965215195,  0.0210229674873221, 0.0044794067972814,
       0.0231612219294984, 0.0400072873861604, 0.0350325045033717, 0.0176874521104835, 0.0037687016953276,
       0.0114650803515925, 0.0198040831320473, 0.0173415064313657, 0.0087554991821638, 0.0018655521668778};

constexpr double3 points_1_3[1]  = {{0.25, 0.25, 0.25}};
constexpr double  weights_1_3[1] = {0.1666666666666667};

constexpr double3 points_3_3[8]  = {{0.1566826373368183, 0.136054976802846, 0.1225148226554414},
                                    {0.0813956670146703, 0.0706797241593969, 0.5441518440112253},
                                    {0.0658386870600444, 0.5659331650728009, 0.1225148226554414},
                                    {0.0342027932367664, 0.2939988006316229, 0.5441518440112253},
                                    {0.5847475632048944, 0.136054976802846, 0.1225148226554414},
                                    {0.3037727648147076, 0.0706797241593969, 0.5441518440112253},
                                    {0.2457133252117134, 0.5659331650728009, 0.1225148226554414},
                                    {0.1276465621203854, 0.2939988006316229, 0.5441518440112253}};
constexpr double  weights_3_3[8] = {0.0369798563588529, 0.0160270405984766, 0.0211570064545241, 0.0091694299214797,
                                    0.0369798563588529, 0.0160270405984766, 0.0211570064545241, 0.0091694299214797};

constexpr double3 points_5_3[27] = {{0.0952198798417149, 0.0821215678634425, 0.0729940240731498},
                                    {0.0670742417520586, 0.0578476039361427, 0.3470037660383519},
                                    {0.0303014811742758, 0.0261332522867349, 0.7050022098884984},
                                    {0.0616960186091465, 0.3795782302805906, 0.0729940240731498},
                                    {0.0434595556538024, 0.2673803204118845, 0.3470037660383519},
                                    {0.0196333029354845, 0.1207918201339025, 0.7050022098884984},
                                    {0.0221843026408197, 0.7301650280476316, 0.0729940240731498},
                                    {0.0156269392579017, 0.514338662174092, 0.3470037660383519},
                                    {0.0070596311395548, 0.2323578005798647, 0.7050022098884984},
                                    {0.422442204031704, 0.0821215678634425, 0.0729940240731498},
                                    {0.2975743150127528, 0.0578476039361427, 0.3470037660383519},
                                    {0.1344322689123834, 0.0261332522867349, 0.7050022098884984},
                                    {0.2737138728231299, 0.3795782302805906, 0.0729940240731498},
                                    {0.1928079567748818, 0.2673803204118845, 0.3470037660383519},
                                    {0.0871029849887995, 0.1207918201339025, 0.7050022098884984},
                                    {0.0984204739396093, 0.7301650280476316, 0.0729940240731498},
                                    {0.0693287858937781, 0.514338662174092, 0.3470037660383519},
                                    {0.0313199947658185, 0.2323578005798647, 0.7050022098884984},
                                    {0.7496645282216929, 0.0821215678634425, 0.0729940240731498},
                                    {0.528074388273447, 0.0578476039361427, 0.3470037660383519},
                                    {0.238563056650491, 0.0261332522867349, 0.7050022098884984},
                                    {0.4857317270371133, 0.3795782302805906, 0.0729940240731498},
                                    {0.3421563578959613, 0.2673803204118845, 0.3470037660383519},
                                    {0.1545726670421146, 0.1207918201339025, 0.7050022098884984},
                                    {0.174656645238399, 0.7301650280476316, 0.0729940240731498},
                                    {0.1230306325296546, 0.514338662174092, 0.3470037660383519},
                                    {0.0555803583920821, 0.2323578005798647, 0.7050022098884984}};

constexpr double weights_5_3[27]
    = {0.0087704749296511, 0.0081626507665467, 0.0016716811314837, 0.0100061425721761, 0.0093126823794705,
       0.0019072034149818, 0.0030478770905182, 0.0028366486956309, 0.0005809353158374, 0.0140327598874417,
       0.0130602412264747, 0.0026746898103739, 0.0160098281154818, 0.0149002918071527, 0.0030515254639709,
       0.0048766033448291, 0.0045386379130095, 0.0009294965053398, 0.0087704749296511, 0.0081626507665467,
       0.0016716811314837, 0.0100061425721761, 0.0093126823794705, 0.0019072034149818, 0.0030478770905182,
       0.0028366486956309, 0.0005809353158374};

constexpr double3 points_7_3[64] = {{0.0622918093484527, 0.0543346112272345, 0.0485005494469973},
                                    {0.0498465213688843, 0.0434790928042876, 0.2386007375518623},
                                    {0.0316174621017319, 0.027578625974397, 0.5170472951043675},
                                    {0.0133649941129659, 0.0116577406689234, 0.7958514178967728},
                                    {0.0477749046478169, 0.2634159753661122, 0.0485005494469973},
                                    {0.0382299507805671, 0.2107880663979872, 0.2386007375518623},
                                    {0.024249114818074, 0.1337020822679904, 0.5170472951043675},
                                    {0.0102503254608295, 0.0565171086994074, 0.7958514178967728},
                                    {0.0275098322538483, 0.5552859757470137, 0.0485005494469973},
                                    {0.0220136396042882, 0.444345324777483, 0.2386007375518623},
                                    {0.013963169280339, 0.2818465778637801, 0.5170472951043675},
                                    {0.0059023610000581, 0.1191391592971237, 0.7958514178967728},
                                    {0.0092331462165736, 0.8185180164205333, 0.0485005494469973},
                                    {0.007388454838612, 0.6549862048169314, 0.2386007375518623},
                                    {0.0046864692747846, 0.415455300374957, 0.5170472951043675},
                                    {0.0019810139747004, 0.175616803962505, 0.7958514178967728},
                                    {0.2960729004920768, 0.0543346112272345, 0.0485005494469973},
                                    {0.2369204605788584, 0.0434790928042876, 0.2386007375518623},
                                    {0.1502777621740506, 0.027578625974397, 0.5170472951043675},
                                    {0.063523802141471, 0.0116577406689234, 0.7958514178967728},
                                    {0.2270740686096784, 0.2634159753661122, 0.0485005494469973},
                                    {0.1817069135037572, 0.2107880663979872, 0.2386007375518623},
                                    {0.1152560157370178, 0.1337020822679904, 0.5170472951043675},
                                    {0.0487197855050096, 0.0565171086994074, 0.7958514178967728},
                                    {0.1307542020795334, 0.5552859757470137, 0.0485005494469973},
                                    {0.1046308045343487, 0.444345324777483, 0.2386007375518623},
                                    {0.0663669280461273, 0.2818465778637801, 0.5170472951043675},
                                    {0.0280539152629691, 0.1191391592971237, 0.7958514178967728},
                                    {0.0438851336893508, 0.8185180164205333, 0.0485005494469973},
                                    {0.0351173176233467, 0.6549862048169314, 0.2386007375518623},
                                    {0.0222747832462335, 0.415455300374957, 0.5170472951043675},
                                    {0.0094157572165539, 0.175616803962505, 0.7958514178967728},
                                    {0.6010919388336914, 0.0543346112272345, 0.0485005494469973},
                                    {0.4809997090649916, 0.0434790928042876, 0.2386007375518623},
                                    {0.305096316747185, 0.027578625974397, 0.5170472951043675},
                                    {0.1289670392928327, 0.0116577406689234, 0.7958514178967728},
                                    {0.461009406577212, 0.2634159753661122, 0.0485005494469973},
                                    {0.3689042825463932, 0.2107880663979872, 0.2386007375518623},
                                    {0.2339946068906244, 0.1337020822679904, 0.5170472951043675},
                                    {0.0989116878988102, 0.0565171086994074, 0.7958514178967728},
                                    {0.2654592727264557, 0.5552859757470137, 0.0485005494469973},
                                    {0.2124231331363059, 0.444345324777483, 0.2386007375518623},
                                    {0.1347391989857251, 0.2818465778637801, 0.5170472951043675},
                                    {0.0569555075431344, 0.1191391592971237, 0.7958514178967728},
                                    {0.0890963004431186, 0.8185180164205333, 0.0485005494469973},
                                    {0.0712957400078596, 0.6549862048169314, 0.2386007375518623},
                                    {0.045222621274442, 0.415455300374957, 0.5170472951043675},
                                    {0.0191160209241682, 0.175616803962505, 0.7958514178967728},
                                    {0.8348730299773155, 0.0543346112272345, 0.0485005494469973},
                                    {0.6680736482749657, 0.0434790928042876, 0.2386007375518623},
                                    {0.4237566168195037, 0.027578625974397, 0.5170472951043675},
                                    {0.1791258473213379, 0.0116577406689234, 0.7958514178967728},
                                    {0.6403085705390734, 0.2634159753661122, 0.0485005494469973},
                                    {0.5123812452695833, 0.2107880663979872, 0.2386007375518623},
                                    {0.3250015078095681, 0.1337020822679904, 0.5170472951043675},
                                    {0.1373811479429903, 0.0565171086994074, 0.7958514178967728},
                                    {0.3687036425521408, 0.5552859757470137, 0.0485005494469973},
                                    {0.2950402980663664, 0.444345324777483, 0.2386007375518623},
                                    {0.1871429577515134, 0.2818465778637801, 0.5170472951043675},
                                    {0.0791070618060454, 0.1191391592971237, 0.7958514178967728},
                                    {0.1237482879158958, 0.8185180164205333, 0.0485005494469973},
                                    {0.0990246027925943, 0.6549862048169314, 0.2386007375518623},
                                    {0.0628109352458909, 0.415455300374957, 0.5170472951043675},
                                    {0.0265507641660217, 0.175616803962505, 0.7958514178967728}};
constexpr double  weights_7_3[64]
    = {2.6134590075074043e-03, 3.3810895785649181e-03, 1.6175887234345097e-03, 2.4398542162060529e-04,
       3.9241267807630809e-03, 5.0767293939918308e-03, 2.4288206593849710e-03, 3.6634579855543284e-04,
       2.5043094430090220e-03, 3.2398803788146009e-03, 1.5500310903539111e-03, 2.3379551527910790e-04,
       6.0137292872017648e-04, 7.7800942593169462e-04, 3.7221707525626329e-04, 5.6142540266951089e-05,
       4.8996144598887573e-03, 6.3387393265891606e-03, 3.0325943803693909e-03, 4.5741467393993018e-04,
       7.3568050090829819e-03, 9.5176609528948922e-03, 4.5534614428672775e-03, 6.8681129750477142e-04,
       4.6949849696344250e-03, 6.0740056403218367e-03, 2.9059398757581788e-03, 4.3831102153432747e-04,
       1.1274313042136668e-03, 1.4585827526946136e-03, 6.9781854580626044e-04, 1.0525391877839165e-04,
       4.8996144598887573e-03, 6.3387393265891606e-03, 3.0325943803693909e-03, 4.5741467393993018e-04,
       7.3568050090829819e-03, 9.5176609528948922e-03, 4.5534614428672775e-03, 6.8681129750477142e-04,
       4.6949849696344250e-03, 6.0740056403218367e-03, 2.9059398757581788e-03, 4.3831102153432747e-04,
       1.1274313042136668e-03, 1.4585827526946136e-03, 6.9781854580626044e-04, 1.0525391877839165e-04,
       2.6134590075074043e-03, 3.3810895785649181e-03, 1.6175887234345097e-03, 2.4398542162060529e-04,
       3.9241267807630809e-03, 5.0767293939918308e-03, 2.4288206593849710e-03, 3.6634579855543284e-04,
       2.5043094430090220e-03, 3.2398803788146009e-03, 1.5500310903539111e-03, 2.3379551527910790e-04,
       6.0137292872017648e-04, 7.7800942593169462e-04, 3.7221707525626329e-04, 5.6142540266951089e-05};
constexpr double3 points_9_3[125] = {{4.3485068432992914e-02, 3.8433274396333254e-02, 3.4578939918214979e-02},
                                     {3.7228589988925066e-02, 3.2903630280304574e-02, 1.7348032077169567e-01},
                                     {2.7481099498812365e-02, 2.4288535716076792e-02, 3.8988638706551931e-01},
                                     {1.6470568774368480e-02, 1.4557132183071371e-02, 6.3433347263088680e-01},
                                     {6.7089045501620738e-03, 5.9295104909977761e-03, 8.5105421294701644e-01},
                                     {3.6320349320621600e-02, 1.9116632379395626e-01, 3.4578939918214979e-02},
                                     {3.1094705420448402e-02, 1.6366198662379478e-01, 1.7348032077169567e-01},
                                     {2.2953238191395598e-02, 1.2081068178837213e-01, 3.8988638706551931e-01},
                                     {1.3756832700313920e-02, 7.2406878886331391e-02, 6.3433347263088680e-01},
                                     {5.6035270404614914e-03, 2.9493264372235890e-02, 8.5105421294701644e-01},
                                     {2.5452983470970993e-02, 4.2283010559815015e-01, 3.4578939918214979e-02},
                                     {2.1790897882472241e-02, 3.6199479967574705e-01, 1.7348032077169567e-01},
                                     {1.6085428780805947e-02, 2.6721439385432638e-01, 3.8988638706551931e-01},
                                     {9.6406681621643286e-03, 1.6015272793830798e-01, 6.3433347263088680e-01},
                                     {3.9269027916266856e-03, 6.5234502821678059e-02, 8.5105421294701644e-01},
                                     {1.3791806769482955e-02, 6.7141585603007559e-01, 3.4578939918214979e-02},
                                     {1.1807490201349172e-02, 5.7481490812699298e-01, 1.7348032077169567e-01},
                                     {8.7159576323212161e-03, 4.2431222048264011e-01, 3.8988638706551931e-01},
                                     {5.2238368273377304e-03, 2.5430800574650780e-01, 6.3433347263088680e-01},
                                     {2.1278088899254824e-03, 1.0358647356188862e-01, 8.5105421294701644e-01},
                                     {4.4624546299289304e-03, 8.7029321309463237e-01, 3.4578939918214979e-02},
                                     {3.8204123794308661e-03, 7.4507849172112484e-01, 1.7348032077169567e-01},
                                     {2.8201211154348519e-03, 5.4999601573694956e-01, 3.8988638706551931e-01},
                                     {1.6902161715118367e-03, 3.2963554472103873e-01, 6.3433347263088680e-01},
                                     {6.8847039341226777e-04, 1.3426940114634409e-01, 8.5105421294701644e-01},
                                     {2.1391665612550587e-01, 3.8433274396333254e-02, 3.4578939918214979e-02},
                                     {1.8313908129108614e-01, 3.2903630280304574e-02, 1.7348032077169567e-01},
                                     {1.3518812602300070e-01, 2.4288535716076792e-02, 3.8988638706551931e-01},
                                     {8.1023880694295114e-02, 1.4557132183071371e-02, 6.3433347263088680e-01},
                                     {3.3003200393884859e-02, 5.9295104909977761e-03, 8.5105421294701644e-01},
                                     {1.7867116129643201e-01, 1.9116632379395626e-01, 3.4578939918214979e-02},
                                     {1.5296458408475716e-01, 1.6366198662379478e-01, 1.7348032077169567e-01},
                                     {1.1291415968958746e-01, 1.2081068178837213e-01, 3.8988638706551931e-01},
                                     {6.7674163941211576e-02, 7.2406878886331391e-02, 6.3433347263088680e-01},
                                     {2.7565502601231005e-02, 2.9493264372235890e-02, 8.5105421294701644e-01},
                                     {1.2521118877662393e-01, 4.2283010559815015e-01, 3.4578939918214979e-02},
                                     {1.0719624406648309e-01, 3.6199479967574705e-01, 1.7348032077169567e-01},
                                     {7.9129256573143056e-02, 2.6721439385432638e-01, 3.8988638706551931e-01},
                                     {4.7425462817050894e-02, 1.6015272793830798e-01, 6.3433347263088680e-01},
                                     {1.9317663381606839e-02, 6.5234502821678059e-02, 8.5105421294701644e-01},
                                     {6.7846212329252420e-02, 6.7141585603007559e-01, 3.4578939918214979e-02},
                                     {5.8084738328039655e-02, 5.7481490812699298e-01, 1.7348032077169567e-01},
                                     {4.2876522420811330e-02, 4.2431222048264011e-01, 3.8988638706551931e-01},
                                     {2.5697687655046143e-02, 2.5430800574650780e-01, 6.3433347263088680e-01},
                                     {1.0467357624338820e-02, 1.0358647356188862e-01, 8.5105421294701644e-01},
                                     {2.1952210424070785e-02, 8.7029321309463237e-01, 3.4578939918214979e-02},
                                     {1.8793803728000477e-02, 7.4507849172112484e-01, 1.7348032077169567e-01},
                                     {1.3873058054682572e-02, 5.4999601573694956e-01, 3.8988638706551931e-01},
                                     {8.3147021395679876e-03, 3.2963554472103873e-01, 6.3433347263088680e-01},
                                     {3.3868012563232708e-03, 1.3426940114634409e-01, 8.5105421294701644e-01},
                                     {4.6349389284272591e-01, 3.8433274396333254e-02, 3.4578939918214979e-02},
                                     {3.9680802447399988e-01, 3.2903630280304574e-02, 1.7348032077169567e-01},
                                     {2.9291253860920191e-01, 2.4288535716076792e-02, 3.8988638706551931e-01},
                                     {1.7555469759302092e-01, 1.4557132183071371e-02, 6.3433347263088680e-01},
                                     {7.1508138280992894e-02, 5.9295104909977761e-03, 8.5105421294701644e-01},
                                     {3.8712736814391435e-01, 1.9116632379395626e-01, 3.4578939918214979e-02},
                                     {3.3142884630225472e-01, 1.6366198662379478e-01, 1.7348032077169567e-01},
                                     {2.4465146557305426e-01, 1.2081068178837213e-01, 3.8988638706551931e-01},
                                     {1.4662982424139090e-01, 7.2406878886331391e-02, 6.3433347263088680e-01},
                                     {5.9726261340373836e-02, 2.9493264372235890e-02, 8.5105421294701644e-01},
                                     {2.7129547724181741e-01, 4.2283010559815015e-01, 3.4578939918214979e-02},
                                     {2.3226243977627861e-01, 3.6199479967574705e-01, 1.7348032077169567e-01},
                                     {1.7144960954007712e-01, 2.6721439385432638e-01, 3.8988638706551931e-01},
                                     {1.0275689971540261e-01, 1.6015272793830798e-01, 6.3433347263088680e-01},
                                     {4.1855642115652750e-02, 6.5234502821678059e-02, 8.5105421294701644e-01},
                                     {1.4700260202585466e-01, 6.7141585603007559e-01, 3.4578939918214979e-02},
                                     {1.2585238555065562e-01, 5.7481490812699298e-01, 1.7348032077169567e-01},
                                     {9.2900696225920232e-02, 4.2431222048264011e-01, 3.8988638706551931e-01},
                                     {5.5679260811302707e-02, 2.5430800574650780e-01, 6.3433347263088680e-01},
                                     {2.2679656745547463e-02, 1.0358647356188862e-01, 8.5105421294701644e-01},
                                     {4.7563923493576320e-02, 8.7029321309463237e-01, 3.4578939918214979e-02},
                                     {4.0720593753589725e-02, 7.4507849172112484e-01, 1.7348032077169567e-01},
                                     {3.0058798598765511e-02, 5.4999601573694956e-01, 3.8988638706551931e-01},
                                     {1.8015491324037240e-02, 3.2963554472103873e-01, 6.3433347263088680e-01},
                                     {7.3381929533197316e-03, 1.3426940114634409e-01, 8.5105421294701644e-01},
                                     {7.1307112955994578e-01, 3.8433274396333254e-02, 3.4578939918214979e-02},
                                     {6.1047696765691351e-01, 3.2903630280304574e-02, 1.7348032077169567e-01},
                                     {4.5063695119540315e-01, 2.4288535716076792e-02, 3.8988638706551931e-01},
                                     {2.7008551449174673e-01, 1.4557132183071371e-02, 6.3433347263088680e-01},
                                     {1.1001307616810091e-01, 5.9295104909977761e-03, 8.5105421294701644e-01},
                                     {5.9558357499139658e-01, 1.9116632379395626e-01, 3.4578939918214979e-02},
                                     {5.0989310851975223e-01, 1.6366198662379478e-01, 1.7348032077169567e-01},
                                     {3.7638877145652100e-01, 1.2081068178837213e-01, 3.8988638706551931e-01},
                                     {2.2558548454157021e-01, 7.2406878886331391e-02, 6.3433347263088680e-01},
                                     {9.1887020079516657e-02, 2.9493264372235890e-02, 8.5105421294701644e-01},
                                     {4.1737976570701080e-01, 4.2283010559815015e-01, 3.4578939918214979e-02},
                                     {3.5732863548607408e-01, 3.6199479967574705e-01, 1.7348032077169567e-01},
                                     {2.6376996250701118e-01, 2.6721439385432638e-01, 3.8988638706551931e-01},
                                     {1.5808833661375429e-01, 1.6015272793830798e-01, 6.3433347263088680e-01},
                                     {6.4393620849698657e-02, 6.5234502821678059e-02, 8.5105421294701644e-01},
                                     {2.2615899172245693e-01, 6.7141585603007559e-01, 3.4578939918214979e-02},
                                     {1.9362003277327161e-01, 5.7481490812699298e-01, 1.7348032077169567e-01},
                                     {1.4292487003102913e-01, 4.2431222048264011e-01, 3.8988638706551931e-01},
                                     {8.5660833967559261e-02, 2.5430800574650780e-01, 6.3433347263088680e-01},
                                     {3.4891955866756107e-02, 1.0358647356188862e-01, 8.5105421294701644e-01},
                                     {7.3175636563081847e-02, 8.7029321309463237e-01, 3.4578939918214979e-02},
                                     {6.2647383779178972e-02, 7.4507849172112484e-01, 1.7348032077169567e-01},
                                     {4.6244539142848443e-02, 5.4999601573694956e-01, 3.8988638706551931e-01},
                                     {2.7716280508506486e-02, 3.2963554472103873e-01, 6.3433347263088680e-01},
                                     {1.1289584650316192e-02, 1.3426940114634409e-01, 8.5105421294701644e-01},
                                     {8.8350271725245877e-01, 3.8433274396333254e-02, 3.4578939918214979e-02},
                                     {7.5638745895907467e-01, 3.2903630280304574e-02, 1.7348032077169567e-01},
                                     {5.5834397771959143e-01, 2.4288535716076792e-02, 3.8988638706551931e-01},
                                     {3.3463882641167336e-01, 1.4557132183071371e-02, 6.3433347263088680e-01},
                                     {1.3630737201182372e-01, 5.9295104909977761e-03, 8.5105421294701644e-01},
                                     {7.3793438696720703e-01, 1.9116632379395626e-01, 3.4578939918214979e-02},
                                     {6.3176298718406099e-01, 1.6366198662379478e-01, 1.7348032077169567e-01},
                                     {4.6634969295471285e-01, 1.2081068178837213e-01, 3.8988638706551931e-01},
                                     {2.7950281578246788e-01, 7.2406878886331391e-02, 6.3433347263088680e-01},
                                     {1.1384899564028617e-01, 2.9493264372235890e-02, 8.5105421294701644e-01},
                                     {5.1713797101266379e-01, 4.2283010559815015e-01, 3.4578939918214979e-02},
                                     {4.4273398167008493e-01, 3.6199479967574705e-01, 1.7348032077169567e-01},
                                     {3.2681379029934826e-01, 2.6721439385432638e-01, 3.8988638706551931e-01},
                                     {1.9587313126864087e-01, 1.6015272793830798e-01, 6.3433347263088680e-01},
                                     {7.9784381439678809e-02, 6.5234502821678059e-02, 8.5105421294701644e-01},
                                     {2.8021339728222633e-01, 6.7141585603007559e-01, 3.4578939918214979e-02},
                                     {2.3989728089996204e-01, 5.7481490812699298e-01, 1.7348032077169567e-01},
                                     {1.7708543481951924e-01, 4.2431222048264011e-01, 3.8988638706551931e-01},
                                     {1.0613468479526766e-01, 2.5430800574650780e-01, 6.3433347263088680e-01},
                                     {4.3231504601169445e-02, 1.0358647356188862e-01, 8.5105421294701644e-01},
                                     {9.0665392357223692e-02, 8.7029321309463237e-01, 3.4578939918214979e-02},
                                     {7.7620775127748579e-02, 7.4507849172112484e-01, 1.7348032077169567e-01},
                                     {5.7297476082096163e-02, 5.4999601573694956e-01, 3.8988638706551931e-01},
                                     {3.4340766476562638e-02, 3.2963554472103873e-01, 6.3433347263088680e-01},
                                     {1.3987915513227195e-02, 1.3426940114634409e-01, 8.5105421294701644e-01}};
constexpr double  weights_9_3[125]
    = {9.3743982176699287e-04, 1.4468812384700513e-03, 1.0226870157805392e-03, 3.6752003800732654e-04,
       4.7165336505936627e-05, 1.6192765852693215e-03, 2.4992547326439219e-03, 1.7665274082243948e-03,
       6.3483178156525477e-04, 8.1470536312884257e-05, 1.4179245325509214e-03, 2.1884801094189891e-03,
       1.5468651695030604e-03, 5.5589240609853490e-04, 7.1339926217055692e-05, 7.1589150194386740e-04,
       1.1049349077045991e-03, 7.8099193862451327e-04, 2.8066278591366335e-04, 3.6018593201298297e-05,
       1.5253647049861846e-04, 2.3543074683011342e-04, 1.6640755405278969e-04, 5.9801395389292364e-05,
       7.6745555217980076e-06, 1.8937723148602979e-03, 2.9229221638361613e-03, 2.0659847302002829e-03,
       7.4244688242791005e-04, 9.5281218508139857e-05, 3.2711872229882421e-03, 5.0488781365648668e-03,
       3.5686564848839944e-03, 1.2824576304595490e-03, 1.6458298715681167e-04, 2.8644251737084793e-03,
       4.4210657010794836e-03, 3.1249050496968355e-03, 1.1229879766854491e-03, 1.4411759995364997e-04,
       1.4462107063785807e-03, 2.2321380949974117e-03, 1.5777235798542782e-03, 5.6698190266016811e-04,
       7.2763086270713590e-05, 3.0814708115588105e-04, 4.7560624166078183e-04, 3.3616879881930321e-04,
       1.2080799678937181e-04, 1.5503780017200706e-05, 2.2509015744614489e-03, 3.4741294130136353e-03,
       2.4555899595375486e-03, 8.8245817276838697e-04, 1.1324943504224717e-04, 3.8880706053227841e-03,
       6.0010000450852492e-03, 4.2416368839619497e-03, 1.5243046257091611e-03, 1.9562019257218064e-04,
       3.4046010087031269e-03, 5.2547941847441290e-03, 3.7142024102955703e-03, 1.3347620434555902e-03,
       1.7129542453323188e-04, 1.7189384016476610e-03, 2.6530766729556368e-03, 1.8752520892253751e-03,
       6.7390385178540664e-04, 8.6484813493276547e-05, 3.6625773050792519e-04, 5.6529648774431441e-04,
       3.9956380849458326e-04, 1.4359007576937279e-04, 1.8427496577589044e-05, 1.8937723148602979e-03,
       2.9229221638361613e-03, 2.0659847302002829e-03, 7.4244688242791005e-04, 9.5281218508139857e-05,
       3.2711872229882421e-03, 5.0488781365648668e-03, 3.5686564848839944e-03, 1.2824576304595490e-03,
       1.6458298715681167e-04, 2.8644251737084793e-03, 4.4210657010794836e-03, 3.1249050496968355e-03,
       1.1229879766854491e-03, 1.4411759995364997e-04, 1.4462107063785807e-03, 2.2321380949974117e-03,
       1.5777235798542782e-03, 5.6698190266016811e-04, 7.2763086270713590e-05, 3.0814708115588105e-04,
       4.7560624166078183e-04, 3.3616879881930321e-04, 1.2080799678937181e-04, 1.5503780017200706e-05,
       9.3743982176699287e-04, 1.4468812384700513e-03, 1.0226870157805392e-03, 3.6752003800732654e-04,
       4.7165336505936627e-05, 1.6192765852693215e-03, 2.4992547326439219e-03, 1.7665274082243948e-03,
       6.3483178156525477e-04, 8.1470536312884257e-05, 1.4179245325509214e-03, 2.1884801094189891e-03,
       1.5468651695030604e-03, 5.5589240609853490e-04, 7.1339926217055692e-05, 7.1589150194386740e-04,
       1.1049349077045991e-03, 7.8099193862451327e-04, 2.8066278591366335e-04, 3.6018593201298297e-05,
       1.5253647049861846e-04, 2.3543074683011342e-04, 1.6640755405278969e-04, 5.9801395389292364e-05,
       7.6745555217980076e-06};

template <typename TV, typename T, int order = 3, int dim = 3>
struct SimplexQuadrature {
    constexpr SimplexQuadrature() : _points{0}, _weights{0} {
        // 编译期间判断积分点的数量不为零
        static_assert(num_points() != 0);

        if constexpr (order == 1 && dim == 3) { assign(_points, _weights, points_1_3, weights_1_3); }
        if constexpr (order == 3 && dim == 3) { assign(_points, _weights, points_3_3, weights_3_3); }
        if constexpr (order == 5 && dim == 3) { assign(_points, _weights, points_5_3, weights_5_3); }
        if constexpr (order == 7 && dim == 3) { assign(_points, _weights, points_7_3, weights_7_3); }
        if constexpr (order == 9 && dim == 3) { assign(_points, _weights, points_9_3, weights_9_3); }

        if constexpr (order == 1 && dim == 2) { assign(_points, _weights, points_1_2, weights_1_2); }
        if constexpr (order == 3 && dim == 2) { assign(_points, _weights, points_3_2, weights_3_2); }
        if constexpr (order == 5 && dim == 2) { assign(_points, _weights, points_5_2, weights_5_2); }
        if constexpr (order == 7 && dim == 2) { assign(_points, _weights, points_7_2, weights_7_2); }
        if constexpr (order == 9 && dim == 2) { assign(_points, _weights, points_9_2, weights_9_2); }

        if constexpr (order == 1 && dim == 1) { assign(_points, _weights, points_1_1, weights_1_1); }
        if constexpr (order == 3 && dim == 1) { assign(_points, _weights, points_3_1, weights_3_1); }
        if constexpr (order == 5 && dim == 1) { assign(_points, _weights, points_5_1, weights_5_1); }
        if constexpr (order == 7 && dim == 1) { assign(_points, _weights, points_7_1, weights_7_1); }
        if constexpr (order == 9 && dim == 1) { assign(_points, _weights, points_9_1, weights_9_1); }
    }

    constexpr void assign(TV* _points, T* _weights, const TV* points, const T* weights) {
        for (int i = 0; i < num_points(); i++) {
            _points[i]  = points[i];
            _weights[i] = weights[i];
        }
    }

    constexpr static int num_points();
    TV                   _points[num_points()];
    T                    _weights[num_points()];
};

template <typename TV, typename T, int order, int dim>
constexpr int SimplexQuadrature<TV, T, order, dim>::num_points() {
    int num_points_1D = 0;
    if constexpr (order == 1) { num_points_1D = 1; }
    if constexpr (order == 3) { num_points_1D = 2; }
    if constexpr (order == 5) { num_points_1D = 3; }
    if constexpr (order == 7) { num_points_1D = 4; }
    if constexpr (order == 9) { num_points_1D = 5; }
    int num_points = 1;
    for (size_t i = 0; i < dim; i++) {
        num_points *= num_points_1D;
    }
    return num_points;
}

// 定义了一个模板变量
template <typename TV, typename T, int order, int dim>
constexpr SimplexQuadrature<TV, T, order, dim> simplex_quadrature{};

}; // namespace npuheart

#endif